{% extends "layout.html" %}

{% block content %}
<h2>Monthly Report</h2>

<!-- FILTER & SEARCH FORM -->
<form method="GET" action="/report" style="margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
    
    <!-- Search by customer name -->
    <input
        type="text"
        name="search"
        placeholder="Search customer name"
        value="{{ search }}"
        style="padding: 6px;"
    />

    <!-- Year selector -->
    <select name="year" style="padding: 6px;">
        {% for y in range(2024, 2031) %}
        <option value="{{ y }}" {% if selected_year == y|string %}selected{% endif %}>
            {{ y }}
        </option>
        {% endfor %}
    </select>

    <!-- Month selector -->
    <select name="month" style="padding: 6px;">
        {% for m in range(1, 13) %}
        {% set mm = "%02d"|format(m) %}
        <option value="{{ mm }}" {% if selected_month == mm %}selected{% endif %}>
            {{ mm }}
        </option>
        {% endfor %}
    </select>

    <button type="submit" style="padding: 6px 12px;">Filter</button>
</form>

<!-- REPORT TABLE -->
<table border="1" cellpadding="10" cellspacing="0" width="100%">
    <thead>
        <tr>
            <th>Customer Name</th>
            <th>Customer Code</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
        {% if data %}
            {% for name, code, status in data %}
            <tr>
                <td>{{ name }}</td>
                <td>{{ code }}</td>
                <td>
                    {% if status == "SUBMITTED" %}
                        <span style="color: green; font-weight: bold;">{{ status }}</span>
                    {% elif status == "NOT SUBMITTED" %}
                        <span style="color: red; font-weight: bold;">{{ status }}</span>
                    {% else %}
                        <span style="color: orange; font-weight: bold;">{{ status }}</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="3" style="text-align: center;">No customers found</td>
            </tr>
        {% endif %}
    </tbody>
</table>

<br>
<a href="{{ url_for('dashboard') }}">â¬… Back to Dashboard</a>

{% endblock %}
